<div id="monitorQuery_all" class="easyui-layout">
	<!--查询条件区 -->
	<div data-options="region:'north',border:false,height:150">
    	 <form cy-form="formData">
            <div class="searchPanel">
            	<div class="panel_title">查询条件</div>
              	<div class="table">
                	<div class="tr">
                        <div class="th" style="height:25px;line-height:25px;">点位：
                        </div>
                        <div class="td" style="width:320px;">
                        	<input class="cy-chooseLocation" size="22" style="width:230px;height:25px;"/>
                        </div>
 						<div class="th"><span class="red">* </span>过车时间：</div>
                        <div class="td" style="width:250px;">
                            <input name="passTimeFr" data-options="required:true" 
                            	class="easyui-datetimebox" style="width:150px;" /> 至
                            <input name="passTimeTo" data-options="required:true" 
                            	class="easyui-datetimebox" style="width:150px;" />
                        </div>
                    </div> 
                    <div class="tr">
                    	<div class="th">方向：</div>
                        <div class="td">
                            <select class="easyui-combobox" name="directionType" data-options="value:''" style="width:120px;">
                                <option value="0">上行</option>
                                <option value="1">下行</option>
                            </select>
                        </div>
                        <div class="th">车道：</div>
                        <div class="td">
                            <input class="easyui-textbox" name="lane" style="width:120px;" />
                        </div>
                        <div class="th">号牌号码：</div>
                        <div class="td">
                            <input class="cy-vehNumberbox" name="plateNbr" style="width:120px;" />
                        </div>
                        <div class="th hide" style="display:none">号牌颜色：</div>
                        <div class="td hide" style="display:none">
                            <input class="easyui-combobox" id="PLATE_COLOR" name="plateColor" style="width:120px"
                                 data-options="valueField:'ID',textField:'NAME',panelHeight:'auto',panelMaxWidth:'200px'" />
                        </div>
                        <div class="th" style="width:200px;">
                            <a class="easyui-linkbutton button" data-options="iconCls:'icon-down'" id="searchSlideDown" 
                            	cy-click="searchSlideDown">更多</a>
                        	<a class="easyui-splitbutton button-search" cy-click="searchForm"  id="searchButton"
                            	 data-options="iconCls:'icon-search'">查询</a>
                            <div id="monitorQueryAll_searchMenu">
                            	<div cy-click="addSearchTag" data-options="iconCls:'icon-add'">添加查询标签</div>
                                <div cy-click="loadSearchTag" data-options="iconCls:'icon-export'">导出查询标签</div>
                            </div>
                        </div>
                    </div> 
                    <div class="tr hide" style="display:none">
                        <div class="th">车辆品牌：</div>
                        <div class="td">
                            <input class="cy-brandbox" name="vehBrand" style="width:120px;" />
                        </div>
                         <div class="th">子品牌：</div>
                        <div class="td">
                            <input class="easyui-textbox" name="vehBrand" style="width:120px;" />
                        </div>	
                        <div class="th">车辆颜色：</div>
                        <div class="td">
                            <input class="easyui-combobox" id="VEHICLE_COLOR" name="vehColor" style="width:120px"
                                   data-options="valueField:'ID',textField:'NAME',panelHeight:'auto',panelMaxWidth:'200px'" />
                        </div>
                        <div class="th">车速：</div>
                        <div class="td">
                            <input class="easyui-textbox" name="speed" style="width:120px;" />
                        </div>
                    </div> 
                    <div class="tr hide" style="display:none">
                    	<div class="th">车辆归属地：</div>
                        <div class="td">
                            <input class="easyui-combobox" id="VEHLOCALIZATION" name="vehLocalization" style="width:120px"
                                data-options="valueField:'ID',textField:'NAME',panelHeight:'auto',panelMaxWidth:'200px'" />
                        </div>
                         <div class="th" style="width:600px;">
                        	<a class="easyui-linkbutton button" data-options="iconCls:'icon-up'" id="searchSlideUp"  
                            	cy-click="searchSlideUp">收起</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="linkbutton_toolbar">
                <a class="easyui-linkbutton button" data-options="iconCls:'icon-export'">勾选导出</a>
                <a class="easyui-linkbutton button" data-options="iconCls:'icon-export'">全部导出</a>
                <a class="easyui-linkbutton button">查看轨迹</a>
                <a class="easyui-linkbutton button">查询视频</a>
            </div>
        </form>
    </div>
    <!--数据展示区 -->
    <div data-options="region:'center',border:true">
        <table cy-datagrid="options" cy-querydata="formData" cy-url="data/passvehicle/data.json"></table>
    </div>
     <!--图片预览区 -->
    <div id="monitorQueryImage" data-options="region:'east',href:'tpls/public/image-view.html'" 
    	style="width:300px;overflow:hidden;">
        
    </div>
</div>
<script type="text/javascript">
	InitPage([],function($scope){
		//查询按钮菜单初始化
		$scope.$("#searchButton").splitbutton({
			menu : $scope.$("#monitorQueryAll_searchMenu")
		})
		$.extend($scope,{
			/**
			 * 设置datagrid参数
			 * @type {Object}
			 */
			options : {
				columns : [[
					{field:"id",checkbox:true},
					{field:"plantNbr",title:"号牌号码",width:100},
					{field:"plantType",title:"号牌种类",width:100},
					{field:"vehLocation",title:"归属地",width:100},
					{field:"districtCode",title:"行政区划",width:100},
					{field:"roadCode",title:"道路名称",width:100},
					{field:"siteCode",title:"通行名称",width:100},
					{field:"passTime",title:"通行时间",width:100},
					{field:"directionType",title:"形式方向",width:100},
					{field:"lane",title:"车道",width:100},
					{field:"deviceNbr",title:"设备编号",width:100},
					{field:"orgCode",title:"管理机构",width:100}
				]],
				onClickRow : clickRow,
				onDblClickRow : dblClickRow			
			},
			/**
			 * 初始化参数
			 * @type {Object}
			 */
			formData : {
				passTimeFr : new Date().format("yyyy-MM-dd 00:00:00"),
				passTimeTo : new Date().format("yyyy-MM-dd hh:mm:ss")
			},
			/**
			 * 增加查询标签
			 */
			addSearchTag : function(){

			},
			/**
			 * 导出查询标签
			 * @return {[type]} [description]
			 */
			loadSearchTag : function(){

			},
			/**
			 * 收起剩余搜索项
			 * @return {[type]} [description]
			 */
			searchSlideUp: function () {
			    $scope.$(".hide").hide();
			    $scope.$("#monitorQuery_all").layout("panel", "north").panel("resize", {
			        height: 150
			    });
			    $scope.$("#monitorQuery_all").layout("resize");
			    $scope.$("#searchSlideUp").hide();
			    $scope.$("#searchSlideDown").show().after($scope.$("#searchButton")).after(" ");
			},
			/**
			 * 展开剩余搜索项
			 * @return {[type]} [description]
			 */
			searchSlideDown: function () {
			    $scope.$(".hide").slideDown("fast");
			    $scope.$("#monitorQuery_all").layout("panel", "north").panel("resize", {
			        height: 227
			    });
			    $scope.$("#monitorQuery_all").layout("resize");
			    $scope.$("#searchSlideDown").hide();
			    $scope.$("#searchSlideUp").show().after($scope.$("#searchButton")).after(" ");
			},
			/**
			 * 查询数据
			 * @return {[type]} [description]
			 */
			searchForm : function(){
				$scope.$search("formData");
			}
		});
		var timeout;
		/**
		 * 点击行事件
		 * @return {[type]} [description]
		 */
		function clickRow(index, data){
			 //设定一个200毫秒延迟，如果用户操作时双击，则不触发单击事件
	        if (timeout) {
	            clearTimeout(timeout);
	            timeout = null;
	            return;
	        }
	        timeout = setTimeout(function () {
	            //充值timeout标记
	            timeout = null;
	            if(data.IMAGE_URL_PATH){
	            	$scope.$setParam("images",[data.IMAGE_URL_PATH]);
	            }
	            //显示图片，参数为url数组
	            $scope.$("#monitorQueryImage").panel("refresh");
	        }, 500);
		}

		/**
		 * 双击行事件
		 * @return {[type]} [description]
		 */
		function dblClickRow(index, data){
			clearTimeout(timeout);
			$scope.$openDialog("passDetail",{
				width : 800,
				height : 500,
				title : "过车详情",
				href : "tpls/passVehicle/vehicleQuery/vehicle-pass-detail.html"
			});
		}
	});
</script>
<style>
#monitorQuery_all .th{
	width:80px;
	text-align:right;
}
#monitorQuery_all .td{
	width:120px;	
}

</style>

