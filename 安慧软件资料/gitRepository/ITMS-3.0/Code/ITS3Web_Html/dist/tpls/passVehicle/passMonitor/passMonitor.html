<div class="easyui-layout" id="passMonitor"><div data-options="region:'west',width:280,border:false" style="border-right:solid 1px #ddd"><div class="easyui-layout"><div data-options="region:'north',border:false,height:57"><div class="table" id="deviceSearch"><div class="tr"><div class="td"><input id="searchParam" class="easyui-textbox" style="width:200px;height:26px;line-height:26px" data-options="prompt:'输入类型、道路、设备名称、状态'"> <a id="searchButton" class="easyui-linkbutton button-search" data-options="iconCls:'icon-search'" cy-click="searchDeviceInTree">查找</a></div></div><div class="tr"><input type="radio" name="treeType" value="1" checked="checked" cy-focus="changeType">按机构 <input type="radio" name="treeType" value="2" cy-focus="changeType">按道路</div></div></div><div data-options="region:'center',border:false"><div id="tree" style="margin:10px 5px"></div></div></div></div><div data-options="region:'east',width:350,border:false,title:'过车信息'" style="border-left:solid 1px #ddd"><table cy-datagrid="options"></table></div><div data-options="region:'center',border:false" style="overflow:hidden"><div id="monitor" class="easyui-panel" data-options="border:false,cls:'monitorLable',fit:true" style="background-color:#666"></div></div></div><script type="text/javascript">InitPage([],function(e){function t(){e.$("#tree").tree({queryParams:{searchType:d},method:"get",url:"data/passvehicle/treeSearch.json",checkbox:!0,onCheck:function(e,t){f||(e.children?t?r(e.children):n(e.children):t?(l.addMonitor(e.id,e.text),h[e.id]=e.id):(l.removeMonitor(e.id),delete h[e.id]))},onLoadSuccess:function(){f=!0;for(var e in h){var t=$(this).tree("find",e);$(this).tree("check",t.target),$(this).tree("expandTo",t.target)}f=!1}})}function r(e){for(var t=0;t<e.length;t++){var n=e[t];n.children?r(n.children):(l.addMonitor(n.id,n.text),h[n.id]=n.id)}}function n(e){for(var t=0;t<e.length;t++){var r=e[t];r.children?n(r.children):(l.removeMonitor(r.id),delete h[r.id])}}function i(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.text.indexOf(t)>=0)return n.id;if(n.children){var o=i(n.children,t);if(o)return o}}}function o(t){var r=e.$("#tree").tree("find",t);e.$("#tree").tree("uncheck",r.target)}function a(e){console.log("stop"+e)}function c(e){console.log("start"+e)}e.$topLayout.layout("collapse","west");var d=1;t();var l=new Monitor({target:e.$("#monitor"),onClose:o,onStart:c,onStop:a});e.$("#searchParam").textbox("textbox").keydown(function(t){"13"==t.keyCode&&e.searchDeviceInTree()}),$.extend(e,{searchDeviceInTree:function(){var t=e.$("#tree").tree("getRoots"),r=e.$("#searchParam").val();if(""!=r){e.$("#tree").tree("collapseAll");var n=i(t,r);if(n){var o=e.$("#tree").tree("find",n);e.$("#tree").tree("select",o.target).tree("expandTo",o.target)}}},changeType:function(t){var r=$(t.currentTarget);r.get(0).checked||("1"==r.val()?e.$("#tree").tree("reload"):e.$("#tree").tree("reload"))},options:{columns:[[{field:"clxz",title:"车辆性质",width:100},{field:"hphm",title:"号牌号码",width:100},{field:"sj",title:"时间("+(new Date).format("yyyy-MM-dd")+")",width:150},{field:"cd",title:"车道",width:100}]],pagination:!1,scrollbarSize:0}});var h={},f=!1});</script><style>div.td{margin-left:5px}</style>