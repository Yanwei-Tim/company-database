<div id="collateQueryDiv" style="height:100%"><div class="toolbar" style="float:left;width:100%;clear:both"><form id="frmCond" class="searchForm" method="post"><div class="searchPanel"><div class="panel_title">查询条件</div><div class="table"><div class="tr"><div class="th">号牌号码：</div><div class="td"><input class="easyui-textbox" name="PlateNbr"></div><div class="th">号牌种类：</div><div class="td"><input class="easyui-combobox" id="cmbPlateType" name="PlateType" data-options="valueField:'ID',textField:'NAME',panelHeight:'auto'"></div><div class="th">违法时间：</div><div class="td"><input class="easyui-datebox" type="text" name="VioTimeFrom"></div><div class="th">到</div><div class="td"><input class="easyui-datebox" type="text"></div></div><div class="tr"><div class="th">采集单位：</div><div class="td"><input class="easyui-combobox" id="cmbOrg" data-options="valueField:'ID',textField:'NAME',panelHeight:'auto'"></div><div class="th">采集道路：</div><div class="td"><input class="easyui-combobox" id="cmbRoad" data-options="valueField:'ID',textField:'NAME',panelHeight:'auto'"></div><div class="th">行驶方向：</div><div class="td"><input class="easyui-combobox" id="cmbDirection" data-options="valueField:'ID',textField:'NAME',panelHeight:'auto'"></div><div class="th">采集设备:</div><div class="td"><input class="easyui-combobox" id="cmbDevice" data-options="valueField:'ID',textField:'NAME',panelHeight:'auto'"></div></div><div class="tr"><div class="th">违法类型：</div><div class="td"><input class="easyui-combobox" id="cmbViolationType" name="ViolationType" data-options="valueField:'ID',textField:'NAME',panelHeight:'auto'"></div><div class="th">行驶速度：</div><div class="td"><input class="easyui-textbox" style="width:50px"></div><div class="th">到</div><div class="td"><input class="easyui-textbox" style="width:50px"></div></div></div><div class="row" style="float:right"><a href="#" class="easyui-linkbutton" style="width:80px" onclick="collateQuery.SearchAsync()" data-options="iconCls:'icon-search'">查询</a> <a href="#" class="easyui-linkbutton" style="width:80px" onclick="collateQuery.SaveAsynce()" data-options="icolCls:'icon-save'">另存为</a></div></div></form></div><table id="dg" class="easyui-datagrid deviceTable" data-options="
               pagination:true,
                    checkOnSelect:true,
                    selectOnCheck:true,
                    rownumbers:true,
                    striped:true,
                    fit:true,
                    fitColumns:true,
                    scrollbarSize:0,
                    toolbar:'#collateQueryDiv .toolbar'"><thead><tr><th data-options="field:'ck',checkbox:true"></th><th data-options="field:'VIOLATION_TYPE',width:10,formatter:CommonService.violationTypeFormat">违法类型</th><th data-options="field:'PLATE_NBR',width:10">号牌号码</th><th data-options="field:'PLATE_TYPE',formatter:CommonService.plateTypeFormat,width:10">号牌种类</th><th data-options="field:'VIOLATION_TIME',width:10">违法时间</th><th data-options="field:'VIOLATION_ADDRESS_DESC',width:10">违法地点</th><th data-options="field:'VIOLATION_DESC',width:10">违法行为描述</th><th data-options="field:'SPEED',width:10">速度</th><th data-options="field:'ORG_CODE',formatter:CommonService.orgFormat,width:10">采集机构</th></tr></thead></table></div><script type="application/javascript">function selectView(e){$(".divView").css("display","none"),$("#"+e).css("display","")}$.parser.onComplete=function(){$.ajax({url:"/ITS3Web.Service.Violation.CommonService/InitPageSysCode",type:"POST",data:{sysCodeTypeDic:JSON.stringify(CommonService.SysTypeDic)},beforeSend:function(e){e.setRequestHeader("ContextID",parent.ContextId)},contentType:"application/json",success:function(e){CommonService.SysCodeDic=e,CommonService.InitPageSysCode()},error:function(e){alert(e.responseText)}})};var CommonService={SysTypeDic:{plateType:"T_DIC_PLATETYPE",plateColor:"T_DIC_PLATECOLOR",violationType:"T_DIC_VIOLATION_TYPE",enforcementCategory:"T_DIC_ENFORCE_CATEGORY",org:"T_DIC_ORG",road:"",device:"",user:"T_DIC_USER",vioAction:"T_DIC_VIO_ACTION"},SysCodeDic:{plateType:null,plateColor:null,violationType:null,enforcementCategory:null,org:null,road:null,device:null,user:null,vioAction:null},InitPageSysCode:function(){$("#cmbPlateType").combobox("loadData",CommonService.SysCodeDic.plateType),$("#cmbViolationType").combobox("loadData",CommonService.SysCodeDic.violationType),$("#cmbEnforcementCategory").combobox("loadData",CommonService.SysCodeDic.enforcementCategory),$("#cmbOrg").combobox("loadData",CommonService.SysCodeDic.org)},code2Name:function(e,o){if(null==e)return o+"无法转换";for(var n=0;n<e.length;n++)if(e[n].ID==o)return e[n].NAME},plateTypeFormat:function(e,o,n){return CommonService.code2Name(CommonService.SysCodeDic.plateType,e)},violationTypeFormat:function(e,o,n){return CommonService.code2Name(CommonService.SysCodeDic.violationType,e)},orgFormat:function(e,o,n){return CommonService.code2Name(CommonService.SysCodeDic.org,e)}},collateQuery={defaultParams:{},SearchAsync:function(){var e=$(".searchForm").getParams();e.ContextId=ContextId;var o=$("#dg").datagrid("getPager").data("pagination").options;e.PageSize=o.pageSize,e.PageNumber=o.pageNumber,$("#dg").datagrid("loading");var n="";$.getJSON(n,function(e){$("#dg").datagrid("loadData",e)}),$.post("/ITS3Web.Service.Violation.ViolationManagerService/QueryViolationAndCount",e,function(e){e=$.parseJSON(e),$("#dg").datagrid("loaded"),""!=e.Error?alert(e.Error):(0==e.Result.total&&alert("没有查询出符合条件的记录！"),sysCodeDic=e.Result,$("#dg").datagrid("loadData",e.Result))})},SaveAsync:function(){$.ajax({url:"/ITS3Web.Service.Violation.ViolationManagerService/SaveVio",type:"POST",data:{},beforeSend:function(e){e.setRequestHeader("ContextID",parent.ContextId)},contentType:"application/json",success:function(e){alert(e)},error:function(e){alert(e.responseText)}})}};</script>