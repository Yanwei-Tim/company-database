<div id="viewImage" class="easyui-layout"><div id="imageViewArea" data-options="region:'center',border:false,cls:'imageView'"></div><div id="imageListArea" data-options="region:'south',border:false,height:50" style="border-top:solid 1px #ccc"></div><div id="fullScreenWindow"></div></div><div><div id="imageMenu" style="margin-left:-1000"><div>圆形放大镜</div><div>大号</div><div>中号</div><div>小号</div><div>保存图片</div></div></div><script>InitPage(["images"],function(e){function t(t){var a=$("<span><img/><span class='retina_square'></span><span>"),s=a.find("img");s.attr("src",t).hide(),e.$("#imageViewArea").panel("body").html("").append(a),s.bind("load",function(){var t=this;g=s.height(),d=s.width();var a=e.$("#imageViewArea").width(),r=e.$("#imageViewArea").height();c=s,i(a,r),$(this).show();var n=$(this).siblings("span");$(t).parent().mousemove(function(e){h(t,e)}).mouseenter(function(e){n.css({backgroundImage:"url('"+$(t).attr("src")+"')"}),n.stop(!0,!0).fadeIn("fast"),h(t,e)}).mouseleave(function(){n.stop(!0,!0).fadeOut("fast")}).bind("contextmenu",function(e){e.preventDefault(),o.menu("show",{left:e.pageX,top:e.pageY}).data({image:$(t),retina:n})}).dblclick(function(e){var i=$("<span><img src='"+$(t).attr("src")+"'/><span>");$("#fullScreenWindow").dialog({title:"图片预览",height:"98%",width:"98%",content:i}).dialog("center")})}).bind("selectstart",function(){return!1})}function i(t,i){(d>t||g>i)&&(g/i>d/t?(c.width("").height(i),e.$("#imageViewArea").width(t).height(i)):(c.height("").width(t),e.$("#imageViewArea").height(i).width(t)))}function a(){if(e.images.length>1)for(var i in e.images){var a=$("<div class='imageList'><span><img  src=' "+e.images[i]+" '/></span></div>");e.$("#imageListArea").append(a),a.find("img").load(function(){var e=$(this).width(),t=$(this).height();e>t?$(this).width("100%"):$(this).height("100%")}),a.click(function(){var e=$(this).find("img").attr("src");t(e)})}else e.$("#viewImage").layout("remove","south")}function s(e,t){var i=($(e).data("image"),$(e).data("retina"));i.hasClass("retina_square")?(i.removeClass("retina_square").addClass("retina_circle"),i.attr("style",""),$(e).menu("setText",{target:t.target,text:"方形放大镜"})):(i.removeClass("retina_circle").addClass("retina_square"),i.attr("style",""),$(e).menu("setText",{target:t.target,text:"圆形放大镜"}))}function r(e,t,i){var a,s=$(e).data("retina");if(s.hasClass("retina_circle"))switch(i){case"l":a={width:180,height:180,"border-radius":90};break;case"m":a={width:150,height:150,"border-radius":75};break;case"s":a={width:120,height:120,"border-radius":60}}else switch(i){case"l":a={width:180,height:110,"border-radius":0};break;case"m":a={width:160,height:90,"border-radius":0};break;case"s":a={width:140,height:70,"border-radius":0}}s.css(a)}function n(e,t){var i=$(e).data("image");oPop=window.open(i.attr("src"),"","width=1, height=1,")}function h(t,i){var a=i.pageX-$(t).offset().left,s=i.pageY-$(t).offset().top,r=e.$("#imageViewArea"),n=i.pageY-r.offset().top,h=i.pageX-r.offset().left,o=$(t).siblings("span");if(0>a||0>s||a>d||s>g)return o.is(":animated")||$(this).trigger("mouseleave"),!1;var c=d/$(t).width()*a-o.width()/2,f=g/$(t).height()*s-o.height()/2;o.css({left:h-o.width()/2,top:n-o.height()/2,backgroundPosition:-1*c+"px "+-1*f+"px"});var l=o.offset().left,m=$(t).offset().left,u=o.offset().top,w=$(t).offset().top,p=w-r.offset().top,v=m-r.offset().left;m>l&&o.css("left",v),l+o.width()>m+$(t).width()&&o.css("left",$(t).width()-o.width()+v),w>u&&o.css("top",p),u+o.height()>w+$(t).height()&&o.css("top",$(t).height()-o.height()+p)}var o,g,d,c;if(e.images&&e.images.length>0)t(e.images[0]),a(),o=e.$("#imageMenu").menu({onClick:function(e){switch(e.text){case"圆形放大镜":s(this,e);break;case"方形放大镜":s(this,e);break;case"大号":r(this,e,"l");break;case"中号":r(this,e,"m");break;case"小号":r(this,e,"s");break;case"保存图片":n(this,e)}}});else{var f=$("<span><img/><span>"),l=f.find("img");l.attr("src","themes/default/images/noPic.jpg").hide(),e.$("#imageViewArea").panel("body").html("").append(f),l.bind("load",function(){g=l.height(),d=l.width();var t=e.$("#imageViewArea").width(),a=e.$("#imageViewArea").height();c=l,$(this).show(),i(t,a)}),e.$("#viewImage").layout("remove","south")}e.$("#imageViewArea").panel({onResize:function(e,t){i(e,t)}})});</script><style>#viewImage #imageViewArea{display:table-cell;vertical-align:middle;text-align:center}#viewImage .imageView{display:table}#imageListArea .imageList{height:49px;width:49px;float:left;margin:0 5px;display:table}#imageListArea .imageList span{cursor:pointer;display:table-cell;height:100%;width:100%;vertical-align:middle;text-align:center}</style>