<div class="easyui-layout"><div data-options="region:'north',border:false"><form method="post" cy-form="formData" data-options="border: false"><div class="table"><div class="tr"><div class="th" style="padding-left:5px">所属机构：</div><div class="td"><select class="easyui-combotree" id="orgCode" name="orgCode" style="width:150px"></select></div><div class="th" style="padding-left:5px">设备类型：</div><div class="td"><input class="easyui-combobox" id="devType" name="devType" data-options="valueField:'id',textField:'text'" style="width:150px"></div><div class="th" style="padding-left:5px">所属道路：</div><div class="td"><input class="easyui-combobox" id="roadCode" name="roadCode" style="width:150px" data-options="valueField:'id',textField:'text'"></div></div><div class="tr"><div class="th" style="padding-left:5px">安装点位：</div><div class="td"><input class="easyui-combobox" id="siteCode" name="siteCode" style="width:150px" data-options="valueField:'id',textField:'text'"></div><div class="th" style="padding-left:5px">设备厂商：</div><div class="td"><input class="easyui-combobox" id="devComp" name="devComp" style="width:150px" data-options="valueField:'id',textField:'text'"></div><div class="th" style="padding-left:5px">维护时间：</div><div class="td"><input class="easyui-datetimebox"></div><div class="th" style="padding-left:5px">至：</div><div class="td"><input class="easyui-datetimebox"></div></div><div class="tr"><div class="td" style="padding-left:5px"><a class="easyui-linkbutton button" data-options="iconCls:'icon-search'" cy-click="searchData">查询</a></div><div class="td" style="padding-left:5px"><a class="easyui-linkbutton button-add" data-options="iconCls:'icon-add'" cy-click="addData">新增</a></div><div class="td" style="padding-left:5px"><a class="easyui-linkbutton button-edit" data-options="iconCls:'icon-edit'" cy-click="addData">修改</a></div><div class="td" style="padding-left:5px"><a class="easyui-linkbutton button-remove" data-options="iconCls:'icon-clear'" cy-click="regInfo">删除</a></div></div></div></form></div><div data-options="region:'center',border:true"><table id="dgv" cy-datagrid="options" cy-querydata="formData" cy-url="data/deviceManage/registdata.json"></table></div></div><script type="text/javascript">InitPage([],function(e){function t(){e.$("#roadCode").combobox("loadData",i.T_DIC_ROAD),e.$("#siteCode").combobox("loadData",i.T_DIC_SITE),e.$("#devType").combobox("loadData",i.T_DIC_DEV),e.$("#devComp").combobox("loadData",i.T_DIC_COMP),e.$(".easyui-datetimebox").datetimebox("setValue",(new Date).format("yyyy-MM-dd hh:mm:ss"))}function a(){e.$getDialog("detailDailog").dialog("close")}var i=[];e.$ajaxRequest({url:"data/deviceManage/chooseInit.json",params:{OrgCode:e.UserInfo.OrgCode},success:function(a){i=a.dicts,t(),e.$("#orgCode").combotree("loadData",a.district_tree)},fail:function(e){alert(e)}}),$.extend(e,{formData:{},changeData:function(e){return e+=1},searchData:function(){e.$search("formData",{},function(e){})},options:{columns:[[{field:"id",checkbox:!0},{title:"设备编号",field:"DEVICE_ID",width:10},{title:"设备名称",field:"DEVICE_NAME",width:10},{title:"安装点位",field:"SITE_CODE",width:10},{title:"所属道路",field:"ROAD_CODE",width:10},{title:"所属机构",field:"ORG_CODE",width:10},{title:"检修周期",field:"REPAIR_PERIOD",width:10},{title:"下次检修时间",field:"REPAIR_TIME",width:10},{title:"维护时间",field:"MAINTENANCE_TIME",width:10}]]},regInfo:function(t){var a=e.$("#dgv").datagrid("getChecked");if($.isEmptyObject(a))console.log("您未选中任何记录");else{for(var i=0;i<a.length;i++)console.log(a[i].DEVICE_NAME);e.searchData()}},addData:function(t){var o={device:i.T_DIC_DEVICE,period:i.T_DIC_PERIOD},d=e.$("#dgv").datagrid("getChecked");console.log(d),e.$setParam("paramData",o),e.$setParam("closeRegistWin",a),e.$openDialog("detailDailog",{width:800,height:490,title:"日常登记信息",href:"tpls/deviceManage/deviceMaintenance/maintenanceDetail[登记详情].html"})}})},function(e){});</script>