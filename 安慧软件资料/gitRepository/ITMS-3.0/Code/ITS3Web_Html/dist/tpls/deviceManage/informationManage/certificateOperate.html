<div id="certificateOperate" class="easyui-layout"><form method="post" id="certificationDetailFrm" cy-form="newData"><div style="width:100%"><div style="position:absolute;overflow-y:auto;height:511px;width:884px"><div class="table" style="margin-top:5px"><div class="tr"><div class="th">证书编号：</div><div class="td"><input class="easyui-textbox" name="CERTIFICATION_NBR"></div><div class="th">检定时间：</div><div class="td"><input id="certificationDate" class="easyui-datebox" name="CERTIFICATED_DATE"></div><div class="th">有效期至：</div><div class="td"><input id="expireDate" class="easyui-datebox" name="EXPIRE_DATE"></div></div><div class="tr"><div class="th">检定机构：</div><div class="td"><input class="easyui-textbox" name="CERTIFICATED_ORG"></div><div class="th">检定人员：</div><div class="td"><input class="easyui-textbox" name="CERTIFICATED_PERSON"></div><div class="th">质检网址：</div><div class="td"><input class="easyui-textbox" name="WEBSITE"></div></div><div class="tr"><div class="td" style="width:100%"><div id="photoDiv" style="float:left"></div><div id="upPhotoTemDiv" class="imgDiv"><img id="upPhoto" src="themes/default/images/upload.png" style="margin:70px"></div></div></div><div class="tr"><div class="td" style="width:100%"><div style="color:red;float:left;font-size:14px">最多只能上传5张检定证书图片</div></div></div><div class="tr"><div style="text-align:center;margin-right:10px;margin-top:10px"><a class="easyui-linkbutton button-save" iconcls="icon-save" cy-click="save">保存</a> <a class="easyui-linkbutton button-close" iconcls="icon-close" cy-click="closeSelf">关闭</a></div></div></div></div></div></form></div><script type="text/javascript">InitPage(["mode","closeSelf","newData"],function(e){function t(){return new plupload.Uploader({runtimes:"html5",browse_button:"upPhoto",container:e.$("#upPhotoTemDiv")[0],url:"upload.php",filters:{max_file_size:"10mb",prevent_duplicates:!0,mime_types:[{title:"照片文件",extensions:"jpg,png,jpeg,bmp,gif"}]},init:{PostInit:function(){},FilesAdded:function(t,a){if(this.files.length>5){for(var o=0;o<a.length;o++)this.removeFile(a[o]);return void alert("最多只能上传5张证书图片！")}5==this.files.length&&e.$("#upPhotoTemDiv").hide();for(var n=0;n<a.length;n++){var r=a[n];i(r)}},FilesRemoved:function(t,i){this.files.length<5&&e.$("#upPhotoTemDiv").show()},Error:function(e,t){console.log(t)}}})}function i(t){var i=t.name;e.imageFiles[i]=t;var a=new FileReader;a.readAsDataURL(t.getSource().getSource()),a.onload=function(a){e.imageUrls[i]=this.result;var o=$("<div class='imgDiv'></div>"),n=$("<img style='width: 270px;height: 270px'/>");n.attr("src",this.result),o.append(n);var r=$("<div style='position: absolute;margin-left: 130px;margin-bottom: 5px'>删除</div>");r.click(function(){$(this).parent().remove(),e.uploader.removeFile(t)}),o.append(r),e.$("#photoDiv").append(o)}}var a=new Date,o=new Date(a.setFullYear(a.getFullYear()+1));e.$("#certificationDate").datebox("setValue",(new Date).format("yyyy-MM-dd")),e.$("#expireDate").datebox("setValue",o.format("yyyy-MM-dd")),e.load=function(){e.uploader=t(),e.uploader.init(),e.imageFiles={},e.imageUrls={}},e.saveCertification=function(){var t=e.$("#certificationDetailFrm").getParams();t.mode=e.mode;var i=[];for(var a in e.imageUrls)i.push(a);null!=i&&i.length>0&&(t.fileUrl=e.imageUrls[i[0]]),e.$setParam("certificationDetailInfo",t),e.closeDialog()}});</script><style>#certificationDetailFrm .imgDiv{float:left;border:dashed 1px silver;margin:5px;height:270px;width:270px}#certificationDetailFrm .th{width:80px;text-align:right}#certificationDetailFrm .td{width:208px}#certificationDetailFrm .td>input[class^=easyui-]{width:170px}</style>