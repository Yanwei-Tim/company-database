<form method="post" id="certificationDetailFrm" cy-from="certificationDetail"><div style="width:100%"><div style="position:absolute;overflow-y:auto;height:511px;width:884px"><div class="table" style="margin-top:5px"><div class="tr"><div class="th">证书编号：</div><div class="td"><input class="easyui-textbox" name="certificaitonNbr"></div><div class="th">检定时间：</div><div class="td"><input id="certificationDate" class="easyui-datebox" name="certificationDate"></div><div class="th">有效期至：</div><div class="td"><input id="expireDate" class="easyui-datebox" name="expireDate"></div></div><div class="tr"><div class="th">检定机构：</div><div class="td"><input class="easyui-textbox" name="certificationOrg"></div><div class="th">检定人员：</div><div class="td"><input class="easyui-textbox" name="certificationPerson"></div><div class="th">质检网址：</div><div class="td"><input class="easyui-textbox" name="webSite"></div></div><div class="tr"><div class="td" style="width:100%"><div id="photoDiv" style="float:left"></div><div id="upPhotoTemDiv" class="imgDiv"><img id="upPhoto" src="themes/default/images/upload.png" style="margin:70px"></div></div></div><div class="tr"><div class="td" style="width:100%"><div style="color:red;float:left;font-size:14px">最多只能上传5张检定证书图片</div><div style="text-align:right;margin-right:10px;margin-top:10px"><a class="easyui-linkbutton button-save" style="width:100px" cy-click="saveCertification">保存</a> <a class="easyui-linkbutton button-disable" style="width:100px" cy-click="closeDialog">关闭</a></div></div></div></div></div></div></form><script type="text/javascript">InitPage(["mode","closeDialog"],function(e){function t(){return new plupload.Uploader({runtimes:"html5",browse_button:"upPhoto",container:e.$("#upPhotoTemDiv")[0],url:"upload.php",filters:{max_file_size:"10mb",prevent_duplicates:!0,mime_types:[{title:"照片文件",extensions:"jpg,png,jpeg,bmp,gif"}]},init:{PostInit:function(){},FilesAdded:function(t,o){if(this.files.length>5){for(var a=0;a<o.length;a++)this.removeFile(o[a]);return void alert("最多只能上传5张证书图片！")}5==this.files.length&&e.$("#upPhotoTemDiv").hide();for(var n=0;n<o.length;n++){var r=o[n];i(r)}},FilesRemoved:function(t,i){this.files.length<5&&e.$("#upPhotoTemDiv").show()},Error:function(e,t){console.log(t)}}})}function i(t){var i=t.name;e.imageFiles[i]=t;var o=new FileReader;o.readAsDataURL(t.getSource().getSource()),o.onload=function(o){e.imageUrls[i]=this.result;var a=$("<div class='imgDiv'></div>"),n=$("<img style='width: 270px;height: 270px'/>");n.attr("src",this.result),a.append(n);var r=$("<div style='position: absolute;margin-left: 130px;margin-bottom: 5px'>删除</div>");r.click(function(){$(this).parent().remove(),e.uploader.removeFile(t)}),a.append(r),e.$("#photoDiv").append(a)}}var o=new Date,a=new Date(o.setFullYear(o.getFullYear()+1));e.$("#certificationDate").datebox("setValue",(new Date).format("yyyy-MM-dd")),e.$("#expireDate").datebox("setValue",a.format("yyyy-MM-dd")),e.load=function(){e.uploader=t(),e.uploader.init(),e.imageFiles={},e.imageUrls={}},e.saveCertification=function(){var t=e.$("#certificationDetailFrm").getParams();t.mode=e.mode;var i=[];for(var o in e.imageUrls)i.push(o);null!=i&&i.length>0&&(t.fileUrl=e.imageUrls[i[0]]),e.$setParam("certificationDetailInfo",t),e.closeDialog()}});</script><style>#certificationDetailFrm .imgDiv{float:left;border:dashed 1px silver;margin:5px;height:270px;width:270px}#certificationDetailFrm .th{width:80px;text-align:right}#certificationDetailFrm .td{width:208px}#certificationDetailFrm .td>input[class^=easyui-]{width:170px}</style>