<div id="appraisalCertificate" class="easyui-layout"><div data-options="region:'north',border:false"><form cy-form="formData"><div class="searchPanel"><div class="panel_title">查询条件</div><div class="table"><div class="tr"><div class="th">所属机构：</div><div class="td"><select class="easyui-combobox" name="CERTIFICATED_ORG"><option>==请选择==</option></select></div><div class="th">设备名称：</div><div class="td"><select class="easyui-combobox" name="DEVICE_NAME"><option>==请选择==</option></select></div><div class="th">过期时间：</div><div class="td"><select class="easyui-combobox" name="EXPIRE_DATE"><option>全部</option><option>已过期</option><option>即将过期</option></select></div><div class="td"><a class="easyui-linkbutton button-search" data-options="iconCls:'icon-search'" cy-click="searchData">查询</a></div></div></div></div></form><div class="linkbutton_toolbar"><a class="easyui-linkbutton button-remove" data-options="iconCls:'icon-remove'" cy-click="removeSomeData">批量删除</a> <span class="remark" style="color:red">备注：有效期止红色表示已过期，橙色表示即将过期。</span></div></div><div data-options="region:'center',border:true"><table id="certificateInfo" cy-datagrid="options" cy-querydata="queryData" cy-url="data/deviceManage/informationManage/certificateData.json"></table></div></div><script type="text/javascript">InitPage([],function(t){function e(t,e,i){var a=$("<a title='编辑' class='button-edit' cy-click='editData("+i+")'></a>"),E=$("<a title='删除' class='button-remove' cy-click='removeData("+i+")'></a>");return a.linkbutton({iconCls:"icon-edit"}),E.linkbutton({iconCls:"icon-remove"}),$("<span/>").append(a).append(" ").append(E).html()}function i(t,e,i){var a;t&&(a=t.replace(/-/g,"/"));var E=(new Date).getTime(),n=new Date(a+" 23:59:59").getTime();if(E>n)return"<span style='color:red'>"+t+"</span>";var l=new Date(a).getTime()-1728e5;return E>=l?"<span style='color:orange'>"+t+"</span>":t}t.options={columns:[[{field:"DEVICE_ID",checkbox:!0},{field:"DEVICE_NAME",title:"设备名称",width:150},{field:"CERTIFICATION_NBR",title:"检定证书编号",width:100},{field:"CERTIFICATED_ORG",title:"检定机构",width:100},{field:"CERTIFICATED_PERSON",title:"检定人员",width:100},{field:"CERTIFICATED_DATE",title:"检定日期",width:150},{field:"WEBSITE",title:"质检网址",width:150},{field:"EXPIRE_DATE",title:"有效期止",width:150,formatter:i},{field:"OPERATER",title:"操作",width:100,formatter:e}]]},t.searchData=function(){t.$search("queryData")},t.editData=function(e){var i=t.$("#certificateInfo").datagrid("getData").rows;t.$setParam("newData",{CERTIFICATION_NBR:i[e].CERTIFICATION_NBR,CERTIFICATED_DATE:i[e].CERTIFICATED_DATE,EXPIRE_DATE:i[e].EXPIRE_DATE,CERTIFICATED_ORG:i[e].CERTIFICATED_ORG,CERTIFICATED_PERSON:i[e].CERTIFICATED_PERSON,EXPIRE_DATE:i[e].EXPIRE_DATE,WEBSITE:i[e].WEBSITE}),t.$openDialog("editDialog",{title:"编辑检定证书",width:900,height:550,href:"tpls/deviceManage/informationManage/certificateOperate.html"},!0),t.$setParam("closeSelf",function(){t.$getDialog("editDialog").dialog("close")})},t.removeData=function(t){alert(t)},t.removeSomeData=function(){var t=$("#certificateInfo").datagrid("getChecked");return 0==t.length?(alert("请选择需要删除的信息！"),!1):void alert("删除")}});</script><style type="text/css">#appraisalCertificate .th{width:80px;text-align:right}#appraisalCertificate .easyui-combobox{width:120px}#appraisalCertificate .button-search{margin-left:10px}#appraisalCertificate .remark{float:right}</style>