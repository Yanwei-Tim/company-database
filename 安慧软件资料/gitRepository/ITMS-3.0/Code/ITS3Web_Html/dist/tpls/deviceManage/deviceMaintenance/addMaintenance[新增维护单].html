<div class="easyui-layout" fit="true"><div region="center" border="false" style="padding:5px;background:#fff;border:1px solid #ccc"><fieldset id="myfieldset"><legend>查询条件</legend><form method="post" cy-form="formData" id="faultInfoFrom"><div class="table"><div class="tr"><div class="th" style="padding-left:5px">设备类型：</div><div class="td"><input class="easyui-combobox" id="devType" name="devType" data-options="valueField:'id',textField:'text',multiple:true"></div><div class="th" style="padding-left:5px">故障类型：</div><div class="td"><input class="easyui-combobox" id="faultType" name="faultType" data-options="valueField:'id',textField:'text'" style="width:150px"></div><div class="th" style="padding-left:5px">设备厂商：</div><div class="td"><input class="easyui-combobox" id="devComp" name="devComp" data-options="valueField:'id',textField:'text'" style="width:150px"></div></div><div class="tr"><div class="th" style="padding-left:5px">发生时间：</div><div class="td"><input class="easyui-datetimebox" style="width:150px"></div><div class="th" style="padding-left:5px;text-align:right">至：</div><div class="td"><input class="easyui-datetimebox" style="width:150px"></div><div class="th"></div><div class="td"><a href="javascript:void(0)" class="easyui-linkbutton button-search" style="max-height:20px;text-align:right" data-options="iconCls:'icon-search',plain:true" cy-click="searchData">查询</a></div></div></div></form></fieldset><table cy-datagrid="options" id="dgv" cy-querydata="formData" cy-url="data/deviceManage/dataFault.json"></table></div><div region="south" border="false" style="text-align:center;padding:5px 0"><a href="javascript:void(0)" class="easyui-linkbutton button-save" data-options="iconCls:'icon-save',plain:true" cy-click="ok">生成维护单</a> <a href="javascript:void(0)" class="easyui-linkbutton button-close" data-options="iconCls:'icon-close',plain:true" cy-click="close_addMaintenance">关闭</a></div><div id="button" class="td" style="display:none"><a href="javascript:void(0)" class="easyui-linkbutton button-enable" cy-click="switchbutton">有效</a> <a href="javascript:void(0)" class="easyui-linkbutton button-disable" cy-click="switchbutton">无效</a></div></div><script type="text/javascript">InitPage(["paraData","close_addMaintenance"],function(t){function e(){t.$("#faultType").combobox("loadData",i.T_DIC_FAULT),t.$("#devType").combobox("loadData",i.T_DIC_DEV),t.$("#devComp").combobox("loadData",i.T_DIC_COMP),t.$(".easyui-datetimebox").datetimebox("setValue",(new Date).format("yyyy-MM-dd hh:mm:ss"))}var i;t.$ajaxRequest({url:"data/deviceManage/chooseInit.json",params:{OrgCode:t.UserInfo.OrgCode},success:function(t){i=t.dicts,e()},fail:function(t){alert(t)}}),$.extend(t,{formData:{},changeData:function(t){return t+=1},searchData:function(){t.$("#devComp").combobox("getValue"),t.$search("formData",{},function(t){})},options:{columns:[[{field:"id",checkbox:!0},{title:"发生时间",field:"START_TIME",width:20,frozen:!0},{title:"结束时间",field:"END_TIME",width:20,frozen:!0},{title:"设备编号",field:"DEVICE_ID",width:20,frozen:!0},{title:"设备名称",field:"DEVICE_NAME",width:10,frozen:!0},{title:"所属机构",field:"ORG_CODE",width:10},{title:"安装点位",field:"SITE_CODE",width:10},{title:"在线/离线",field:"REPAIR_TIME",width:10},{title:"故障/报警",field:"FAULT_ALARM",width:10},{title:"故障/报警类型",field:"FAULT_TYPE",width:10},{title:"采集方式",field:"COLLECT_METHOD",width:10},{title:"描述",field:"REMARK",width:10},{title:"处理状态",field:"PROCESS_STATE",width:10},{title:"有效/无效",field:"IS_VALIDITY",width:10,formatter:function(e,i){return"有效"==e?(t.$("#button").find("a").eq(0).show(),t.$("#button").find("a").eq(1).hide(),t.$("#button").html()):(t.$("#button").find("a").eq(0).hide(),t.$("#button").find("a").eq(1).show(),t.$("#button").html())}}]]}}),t.ok=function(){var e=t.$("#dgv").datagrid("getChecked");if($.isEmptyObject(e))console.log("您未选中任何记录");else{for(var i=0;i<e.length;i++)console.log(e[i].DEVICE_NAME);t.searchData()}t.close_addMaintenance()}},function(t){});</script><style type="text/css">body{font:12px/20px "微软雅黑","宋体",Arial,sans-serif,Verdana,Tahoma;padding:0;margin:0}#faultInfoFrom .th{width:60px;text-align:right}fieldset{border:#ddd solid 1px;padding:0 10px 0 10px;margin-bottom:10px}fieldset legend{color:#2A6496;font-size:12px;background:#fff;border-bottom:0;width:auto;margin-bottom:0}</style>